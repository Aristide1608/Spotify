<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Spotify Recap</title>
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link href="style.css" rel="stylesheet" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container">
        <a class="navbar-brand" href="#">Votre récapitulatif d'écoute</a>
      </div>
    </nav>

    <div class="container mt-4">
      <div
        id="topTracksCarousel"
        class="carousel slide"
        data-bs-ride="carousel"
      >
        <div class="carousel-inner">
          <!-- Dynamically populated carousel items will go here -->
        </div>
        <button
          class="carousel-control-prev"
          type="button"
          data-bs-target="#topTracksCarousel"
          data-bs-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button
          class="carousel-control-next"
          type="button"
          data-bs-target="#topTracksCarousel"
          data-bs-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>

      <div class="mt-4 text-center">
        <h2>Écoutez toujours plus sur Spotify</h2>
        <p>
          Découvrez de nouvelles musiques et alimentez votre propre playlist.
        </p>
        <a href="https://www.spotify.com/" class="btn btn-primary"
          >Télécharger Spotify</a
        >
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        fetch("data.json")
          .then((response) => response.json())
          .then((jsonData) => {
            var carouselInner = document.querySelector(".carousel-inner");
            jsonData.forEach(function (cardData, index) {
              var carouselItem = document.createElement("div");
              carouselItem.classList.add("carousel-item");
              if (index === 0) {
                carouselItem.classList.add("active");
              }

              var itemHTML = `
              <img src="${cardData.album.images[1].url}" class="d-block w-100" alt="${cardData.album.name}">
              <div class="col-md-4 mb-4 col-lg-3">
              <div class="carousel-caption d-none d-md-block">
                <h5>${cardData.album.name}</h5>
                <p>${cardData.album.label}</p>
                <audio src="${cardData.preview_url}" id="audio-${cardData.id}"></audio>
                <button class="btn btn-success btn-play" data-audio-id="audio-${cardData.id}"><i class="fas fa-play"></i></button>
              </div>
              </div>
            `;
              carouselItem.innerHTML = itemHTML;
              carouselInner.appendChild(carouselItem);
            });

            // Event listener for play/pause buttons
            var playButtons = document.querySelectorAll(".btn-play");
            playButtons.forEach(function (button) {
              button.addEventListener("click", function () {
                var audioId = this.getAttribute("data-audio-id");
                var audio = document.getElementById(audioId);
                if (audio.paused) {
                  audio.play();
                  this.innerHTML = '<i class="fas fa-pause"></i>';
                } else {
                  audio.pause();
                  this.innerHTML = '<i class="fas fa-play"></i>';
                }
              });
            });
          })
          .catch((error) => {
            console.error("Error fetching JSON data:", error);
          });
      });
    </script>
  </body>
</html>
